/*
 * SPDX-License-Identifier: Apache-2.0
 */

 / {
    motors: motors {
        compatible = "pwm-motors";
        backL: backL {
            pwms = <&pwm1 1 0 PWM_POLARITY_NORMAL>;
        };
        frontR: frontR {
            pwms = <&pwm2 2 0 PWM_POLARITY_NORMAL>;
        };
        frontL: frontL {
            pwms = <&pwm3 3 0 PWM_POLARITY_NORMAL>;
        };
        backR: backR {
            pwms = <&pwm4 4 0 PWM_POLARITY_NORMAL>;
        };
    };

    joystick {
        compatible = "uart-microblue-app";
        uart = <&usart3>;
    };
 };


&usart3 {
    current-speed = <38400>;
};

// The original pwm1 define in the timers1 node is not needed.
/delete-node/ &pwm1;

&timers3 {
    status = "okay";

    pwm1: pwm1 {
        compatible = "st,stm32-pwm";
        status = "okay";
        #pwm-cells = <3>;
        pinctrl-0 = <&tim3_ch1_pwm_out_pa6>;
        pinctrl-names = "default";
    };

    pwm2: pwm2 {
        compatible = "st,stm32-pwm";
        status = "okay";
        #pwm-cells = <3>;
        pinctrl-0 = <&tim3_ch2_pwm_out_pa7>;
        pinctrl-names = "default";
    };

    pwm3: pwm3 {
        compatible = "st,stm32-pwm";
        status = "okay";
        #pwm-cells = <3>;
        pinctrl-0 = <&tim3_ch3_pwm_out_pb0>;
        pinctrl-names = "default";
    };

    pwm4: pwm4 {
        compatible = "st,stm32-pwm";
        status = "okay";
        #pwm-cells = <3>;
        pinctrl-0 = <&tim3_ch4_pwm_out_pb1>;
        pinctrl-names = "default";
    };
};
